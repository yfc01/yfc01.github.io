---
title: "æ·»åŠ æ–‡ç« ç›®å½•æ ‘" #æ ‡é¢˜
date: 2024-10-29T23:42:50+08:00 #åˆ›å»ºæ—¶é—´
lastmod: 2024-11-29T23:42:50+08:00 #æ›´æ–°æ—¶é—´
author: ["yfc01"] #ä½œè€…
categories: 
- blog
tags: 
- .Site.Pages
description: "æ·»åŠ æ–‡ç« ç›®å½•æ ‘æ–¹ä¾¿æµè§ˆæ–‡ç« åŠå…¶å½’ç±»" #æè¿°
weight: # è¾“å…¥1å¯ä»¥é¡¶ç½®æ–‡ç« ï¼Œç”¨æ¥ç»™æ–‡ç« å±•ç¤ºæ’åºï¼Œä¸å¡«å°±é»˜è®¤æŒ‰æ—¶é—´æ’åº
slug: "Add an article table of contents tree"
draft: false # æ˜¯å¦ä¸ºè‰ç¨¿
comments: true #æ˜¯å¦å±•ç¤ºè¯„è®º
showToc: true # æ˜¾ç¤ºç›®å½•
TocOpen: true # è‡ªåŠ¨å±•å¼€ç›®å½•
hidemeta: false # æ˜¯å¦éšè—æ–‡ç« çš„å…ƒä¿¡æ¯ï¼Œå¦‚å‘å¸ƒæ—¥æœŸã€ä½œè€…ç­‰
disableShare: true # åº•éƒ¨ä¸æ˜¾ç¤ºåˆ†äº«æ 
showbreadcrumbs: false #é¡¶éƒ¨æ˜¾ç¤ºå½“å‰è·¯å¾„
cover:
    image: "" #å›¾ç‰‡è·¯å¾„ï¼šposts/tech/æ–‡ç« 1/picture.png
    caption: "" #å›¾ç‰‡åº•éƒ¨æè¿°
    alt: ""
    relative: false
---

## å‰è¨€

æ–‡ç« çš„å±•ç¤ºæ–¹å¼ä¸€ç›´æ˜¯ä¸€ä¸ªä»¤äººå¤´ç—›çš„é—®é¢˜ï¼Œå°±æ¯”å¦‚æˆ‘æƒ³è¦å°†åšå®¢æ‰“é€ æˆä¸€ä¸ªå¹³æ—¶ç”¨äºè®°å½•è‡ªå·±å­¦ä¹ å†…å®¹çš„ç«™ç‚¹ï¼Œå¿…ç„¶å°‘ä¸äº†å¤šå±‚çº§çš„æ–‡ä»¶ç›®å½•ã€‚hugoçš„å„ç§ä¸»é¢˜éƒ½é¿å…ä¸äº†ç–å¿½äº†æ–‡ç« ç›®å½•è¿™ä¸€ä¸ªå…³é”®åŠŸèƒ½ï¼Œå°±è¿ä»¥å„ç§èŠ±å¼ç»„ä»¶ä¸ºä¼˜åŠ¿çš„hexoéƒ½å¾ˆéš¾åšå¥½è¿™ä¸€ç‚¹ã€‚è€Œä»Šå¤©ï¼Œæˆ‘å†³å®šè‡ªå·±å®ç°ä¸€ä¸ªèƒ½å±•ç¤ºå¤šå±‚çº§ç›®å½•çš„åŠŸèƒ½ã€‚å¥½åœ¨hugoæä¾›`.Site.Pages`å‚æ•°ï¼Œè¯¥å‚æ•°åŒ…å«ç«™ç‚¹å†…å®¹æ•°ç»„ï¼Œå¯ä»¥ç”¨äºæ£€ç´¢æ–‡ç« ç”Ÿæˆæ–‡ç« åˆ—è¡¨ã€‚

## æ­¥éª¤

### æ–°å»ºæ¨¡æ¿æ–‡ä»¶

æ–°å»º`/layouts/partials/directory_structure.html` æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ã€‚

```html
<style>
    .folder-title {
        cursor: pointer;
        font-size: 1.2em; /* æ–‡ä»¶å¤¹æ ‡é¢˜å­—ä½“å¤§å° */
        margin: 10px 0; /* ä¸Šä¸‹é—´è· */
        transition: color 0.3s; /* é¢œè‰²è¿‡æ¸¡æ•ˆæœ */
    }

    ul {
        list-style-type: none; /* å»æ‰æ‰€æœ‰åˆ—è¡¨é¡¹çš„æ ‡è®° */
        padding: 0; /* å»æ‰é»˜è®¤çš„å†…è¾¹è· */
        margin: 0; /* å»æ‰é»˜è®¤çš„å¤–è¾¹è· */
    }

    .sub-directory {
        padding-left: 20px; /* å­ç›®å½•ç¼©è¿› */
        max-height: 0; /* åˆå§‹é«˜åº¦ä¸º0ï¼Œéšè—å†…å®¹ */
        overflow: hidden; /* éšè—æº¢å‡ºå†…å®¹ */
        transition: max-height 0.3s ease; /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
    }

    .sub-directory.visible {
        max-height: 100vh; /* è®¾ç½®ä¸€ä¸ªåˆç†çš„æœ€å¤§é«˜åº¦ï¼Œç¡®ä¿å†…å®¹èƒ½å®Œå…¨æ˜¾ç¤º */
    }

    .sub-directory a {
        display: block; /* ä½¿é“¾æ¥å æ»¡æ•´è¡Œ */
        padding: 8px 0; /* ä¸Šä¸‹é—´è· */
        font-size: 1em; /* æ–‡ç« æ ‡é¢˜å­—ä½“å¤§å° */
        text-decoration: none; /* å»æ‰ä¸‹åˆ’çº¿ */
        transition: background-color 0.3s; /* èƒŒæ™¯é¢œè‰²è¿‡æ¸¡æ•ˆæœ */
    }

    .directory-item {
        margin-bottom: 10px; /* æ¯ä¸ªç›®å½•é¡¹çš„åº•éƒ¨é—´è· */
        border-bottom: 1px solid;
    }

    .directory-item li:last-child .directory-item{
        border-bottom: none;
    }
</style>

<!-- partials/directory.html -->
{{ $pages := . }}

{{ if $pages }}
<ul style="padding-left: 20px;">
    {{ range $pages }}
    <li>
        <div class="directory-item">
            {{ if .IsSection }} <!-- åˆ¤æ–­æ˜¯å¦ä¸ºæ–‡ä»¶å¤¹ -->
            <div class="folder-title" onclick="toggleVisibility(this)">ğŸ—‚ï¸ {{ .Title }}</div>
            <ul class="sub-directory"> <!-- é»˜è®¤éšè—å­ç›®å½• -->
                {{ if .Pages }}
                {{ partial "directory_structure.html" .Pages }} <!-- é€’å½’è°ƒç”¨ -->
                {{ end }}
            </ul>
            {{ else }} <!-- å¦åˆ™å°±æ˜¯æ–‡ç«  -->
            <a href="{{ .RelPermalink }}">ğŸ“ƒ {{ .Title }}</a>
            {{ end }}
        </div>
    </li>
    {{ end }}
</ul>
{{ end }}

<script>
    function toggleVisibility(element) {
        const subDirectory = element.nextElementSibling; // è·å–ä¸‹ä¸€ä¸ªå…„å¼Ÿå…ƒç´ 
        if (subDirectory) {
            // åˆ‡æ¢æ˜¾ç¤ºçŠ¶æ€
            subDirectory.classList.toggle("visible"); // åˆ‡æ¢å¯è§æ€§ç±»
        }
    }
</script>
```

æ–°å»º`/layouts/_default/contents.html` æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ã€‚

```html
{{- define "main" }}

{{ $firstPage := index (where .Site.Pages "Section" "post") 0 }}

{{ if $firstPage }}
{{ partial "directory_structure.html" $firstPage.Pages }} <!-- è°ƒç”¨éƒ¨åˆ†ä»¥ç”Ÿæˆç›®å½• -->
{{ else }}
<p>No posts found.</p>
{{ end }}

{{- end }}{{/* end main */ -}}
```

### ä¿®æ”¹å…¨å±€é…ç½®æ–‡ä»¶

ä¿®æ”¹`config.yaml`æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œåœ¨å¤´éƒ¨å¯¼èˆªæ æ·»åŠ â€œç›®å½•â€é€‰é¡¹ã€‚

```yaml
languages:
  zh:
    # ---------------------------
    # å¯¼èˆªèœå•é…ç½®
    # ---------------------------
    menu:
      main:
        - name: ç›®å½•
          pageRef: contents
          weight: 2
```

### æ·»åŠ å¯¼èˆªæ å¯¹åº”æ–‡ä»¶

æ–°å»º`post/contents.md`ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ã€‚

```markdown
---
title: ""
layout: contents
summary: contents
---
```

### ä¿®æ”¹post/_index.mdæ–‡ä»¶

åœ¨è¿™ä¸€æ­¥çš„ç›®çš„æ˜¯ä¸ºäº†è®©postç›®å½•ç›¸å…³ä¿¡æ¯æ’åœ¨`.Site.Pages`æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œé˜²æ­¢åœ¨å…¶ä»–æ–‡ç« è®¾ç½®äº†æƒé‡åï¼Œå¯¼è‡´çš„ç›®å½•ç°å®bugã€‚æ·»åŠ å¦‚ä¸‹å†…å®¹ã€‚

```markdown
weight: 1
```

åˆ°æ­¤ä¸ºæ­¢ï¼Œä¾¿æ·»åŠ äº†ä¸€ä¸ªèƒ½å¤Ÿé€’å½’æ£€ç´¢ç”Ÿæˆç›®å½•çš„åŠŸèƒ½ï¼Œä½†æ˜¯æ ·å¼æ¯”è¾ƒä¸‘ï¼Œè‡ªè¡Œä¿®æ”¹ã€‚

### ä¼˜åŒ–ç»†èŠ‚

ä¿®æ”¹`\layouts\_defaultbaseof.html`æ–‡ä»¶ä»£ç ï¼Œé˜²æ­¢èƒŒæ™¯æ•ˆæœä¸ç”Ÿæ•ˆï¼Œæ‰¾åˆ°å¹¶æ›¿æ¢éƒ¨åˆ†æ ·å¼ä»£ç ï¼Œè¯¦ç»†ä»£ç å¦‚ä¸‹ã€‚

```html
<body class="
{{- if (or (ne .Kind `page` ) (eq .Layout `archives`) (eq .Layout `search`) (eq .Layout `about`)) -}}
{{- print "list" -}}
{{- end -}}
{{- if eq site.Params.defaultTheme `dark` -}}
{{- print " dark" }}
{{- end -}}
" id="top">
    
// æ›¿æ¢ä¸º 
    
<body class="
{{- if (or (ne .Kind `page` ) (eq .Layout `archives`) (eq .Layout `search`) (eq .Layout `about`) (eq .Layout `contents`)) -}}
{{- print "list" -}}
{{- end -}}
{{- if eq site.Params.defaultTheme `dark` -}}
{{- print " dark" }}
{{- end -}}
" id="top">
```

## å°†æ–‡ä»¶å¤¹æ”¾åœ¨æ–‡ç« å‰

æœ‰æ—¶å€™å¯¹åšå®¢æ–‡ç« è¿›è¡Œåˆ†ç±»çš„æ—¶å€™ï¼Œéš¾ä»¥é¿å…çš„ä¼šé‡åˆ°éœ€è¦åœ¨æ–‡ä»¶å¤¹å†…æ—¢å­˜æ”¾æ–‡ç« åˆè¦å­˜æ”¾æ–‡ä»¶å¤¹çš„æƒ…å†µï¼Œå°±åƒç”µè„‘ä¸Šçš„æ–‡ä»¶å¤¹ä¸å¯èƒ½åªå­˜æ”¾æ–‡ä»¶æˆ–è€…æ˜¯æ–‡ä»¶å¤¹ï¼Œæ›´å¤šæ—¶å€™æ˜¯æ··æ­çš„ã€‚è¿™ä¸ªæ—¶å€™æŒ‰ç…§ä¸€èˆ¬ç”¨æˆ·çš„ç”µè„‘ä½¿ç”¨ä¹ æƒ¯ï¼Œæ–‡ä»¶å¤¹æ˜¯è¦æ”¾åœ¨æ–‡ä»¶ä¸Šæ–¹çš„ï¼Œå¯hugoä¸­`.Site.Pages`å†…å®¹æ•°ç»„å­˜æ”¾é¡ºåºæ˜¯æ–‡ç« åœ¨å‰ï¼Œæ–‡ä»¶å¤¹åœ¨åï¼Œç»™äººä¸€ç§å¾ˆåäººç±»çš„æ„Ÿè§‰ã€‚è¿™é‡Œé’ˆå¯¹è¿™éƒ¨åˆ†å°ç¼ºé™·ï¼Œå¯¹éƒ¨åˆ†ä»£ç è¿›è¡Œä¼˜åŒ–ã€‚

åœ¨`/layouts/partials/directory_structure.html`ä¸­å¯¹éƒ¨åˆ†ä»£ç è¿›è¡Œæ›¿æ¢ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```html
//æºä»£ç 
{{ $pages := . }}

{{ if $pages }}
<ul style="padding-left: 20px;">
    {{ range $pages }}
    <li>
        <div class="directory-item">
            {{ if .IsSection }} <!-- åˆ¤æ–­æ˜¯å¦ä¸ºæ–‡ä»¶å¤¹ -->
            <div class="folder-title" onclick="toggleVisibility(this)">ğŸ—‚ï¸ {{ .Title }}</div>
            <ul class="sub-directory"> <!-- é»˜è®¤éšè—å­ç›®å½• -->
                {{ if .Pages }}
                {{ partial "directory_structure.html" .Pages }} <!-- é€’å½’è°ƒç”¨ -->
                {{ end }}
            </ul>
            {{ else }} <!-- å¦åˆ™å°±æ˜¯æ–‡ç«  -->
            <a href="{{ .RelPermalink }}">ğŸ“ƒ {{ .Title }}</a>
            {{ end }}
        </div>
    </li>
    {{ end }}
</ul>
{{ end }}

```

æ›¿æ¢æˆå¦‚ä¸‹ä»£ç ï¼š

```html
//æ›¿æ¢ä»£ç 
{{ $pages := . }}

{{ if $pages }}
<ul style="padding-left: 20px;">
    {{- $folders := where . "IsSection" true }} <!-- è·å–æ‰€æœ‰æ–‡ä»¶å¤¹ -->
    {{- $posts := where . "IsSection" false }} <!-- è·å–æ‰€æœ‰æ–‡ç«  -->

    <!-- æ¸²æŸ“æ–‡ä»¶å¤¹ -->
    {{ range $folders }}
    <li>
        <div class="directory-item">
            <div class="folder-title" onclick="toggleVisibility(this)">ğŸ—‚ï¸ {{ .Title }}</div>
            <ul class="sub-directory">
                {{ if .Pages }} <!-- å¦‚æœæ˜¯ Sectionï¼Œé€’å½’æ¸²æŸ“å…¶å­é¡µé¢ -->
                {{ partial "directory_structure.html" .Pages }}
                {{ end }}
            </ul>
        </div>
    </li>
    {{ end }}

    <!-- æ¸²æŸ“æ–‡ç«  -->
    {{ range $posts }}
    <li>
        <div class="directory-item">
            <a href="{{ .RelPermalink }}">ğŸ“ƒ {{ .Title }}</a>
        </div>
    </li>
    {{ end }}
</ul>
{{ end }}
```

## å‚è€ƒé“¾æ¥

<a href="https://hugo-docs.netlify.app/variables/site/" target="_blank">ç½‘ç«™å˜é‡ | Hugo æ–‡æ¡£</a>